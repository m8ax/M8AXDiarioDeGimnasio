<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>- M8AX - Calendarios Anuales Y Noticiero - M8AX -</title>
    <style>
        body {
        margin: 0;
        padding: 0;
        background: #111;
        color: #eee;
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        height: 100vh;
        overflow: hidden;
        }
        .wrapper {
        width: 100%;
        max-width: 1800px;
        padding: 10px;
        box-sizing: border-box;
        }
        .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
        margin-bottom: 10px;
        }
        .left-header {
        display: flex;
        align-items: center;
        gap: 10px;
        }
        .clock {
        font-size: 18px;
        min-width: 200px;
        }
        .year-container {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 18px;
        }
        .year-title {
        font-size: 32px;
        font-weight: bold;
        }
        select {
        background: #1e1e1e;
        color: #eee;
        border: 1px solid #555;
        padding: 6px 10px;
        font-size: 18px;
        border-radius: 6px;
        }
        .ticker-container {
        overflow: hidden;
        white-space: nowrap;
        font-size: 16px;
        color: #ccc;
        flex: 1;
        margin-top: 5px;
        }
        .ticker {
        display: inline-block;
        padding-left: 100%;
        animation: scroll-left 120s linear infinite;
        }
        @keyframes scroll-left {
        0% { transform: translateX(0); }
        100% { transform: translateX(-100%); }
        }
        .months {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
        height: calc(100vh - 70px);
        overflow-y: auto;
        padding-right: 10px;
        }
        .month {
        background: #1e1e1e;
        border: 1px solid #333;
        border-radius: 6px;
        padding: 10px;
        }
        .month-name {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 8px;
        }
        .days-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
        font-size: 13px;
        }
        .day-name {
        font-weight: bold;
        text-align: center;
        color: #bbb;
        }
        .day {
        text-align: center;
        padding: 4px;
        border-radius: 4px;
        background: #222;
        }
        .empty {
        background: transparent;
        }
        .day.today {
        background: yellow;
        color: #111;
        font-weight: bold;
        }
    </style>
</head>
<body>
<div id="particles-js"
     style="position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1;"></div>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<div class="wrapper">
    <div class="header">
        <div class="left-header">
            <div class="clock" id="clock"></div>
            <span>|</span>&nbsp;&nbsp;&nbsp;
            <div class="year-container">
                <div class="year-title" id="year"></div>
                <select id="yearSelector"></select>
            </div>
        </div>
        <div class="ticker-container" id="newsTicker">Cargando noticias…</div>
    </div>
    <div class="months" id="months"></div>
</div>
<script>
    function getRandomColor() {
        return '#' + Math.floor(Math.random() * 16777215).toString(16);
    }
    particlesJS("particles-js", {
        particles: {
            number: { value: 80, density: { enable: true, value_area: 800 } },
            color: { value: "#ffffff" },
            shape: { type: "circle", stroke: { width: 0, color: "#000000" }, polygon: { nb_sides: 5 } },
            opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false } },
            size: { value: 3, random: true, anim: { enable: true, speed: 2, size_min: 0.1, sync: false } },
            line_linked: { enable: true, distance: 150, color: getRandomColor(), opacity: 0.4, width: 1 },
            move: { enable: true, speed: 3, direction: "none", random: true, straight: false, out_mode: "bounce", bounce: true, attract: { enable: false, rotateX: 600, rotateY: 1200 } }
        },
        interactivity: { detect_on: "canvas", events: { onhover: { enable: true, mode: "bubble" }, onclick: { enable: true, mode: "push" }, resize: true }, modes: { bubble: { distance: 200, size: 6, duration: 2, opacity: 0.8, speed: 3 }, push: { particles_nb: 4 } } },
        retina_detect: true
    });
</script>
<script>
    const monthNames = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
    const dayNames = ["L","M","X","J","V","S","D"];
    const yearTitle = document.getElementById("year");
    const yearSelector = document.getElementById("yearSelector");
    const monthsContainer = document.getElementById("months");
    const clock = document.getElementById("clock");
    function fillYearSelector(currentYear) {
        const start = currentYear - 1000;
        const end = currentYear + 1000;
        yearSelector.innerHTML = "";
        for (let y = start; y <= end; y++) {
            const opt = document.createElement("option");
            opt.value = y;
            opt.textContent = y;
            if (y === currentYear) opt.selected = true;
            yearSelector.appendChild(opt);
        }
    }
    function updateClock() {
        const now = new Date();
        const hh = String(now.getHours()).padStart(2,'0');
        const mm = String(now.getMinutes()).padStart(2,'0');
        const ss = String(now.getSeconds()).padStart(2,'0');
        const dd = String(now.getDate()).padStart(2,'0');
        const mmth = String(now.getMonth()+1).padStart(2,'0');
        const yyyy = now.getFullYear();
        clock.textContent = `${hh}:${mm}:${ss} | ${dd}/${mmth}/${yyyy}`;
    }
    function generateCalendar(year) {
        yearTitle.textContent = year;
        monthsContainer.innerHTML = "";
        const today = new Date();
        monthNames.forEach((name, index) => {
            const monthDiv = document.createElement("div");
            monthDiv.className = "month";
            const title = document.createElement("div");
            title.className = "month-name";
            title.textContent = name;
            monthDiv.appendChild(title);
            const grid = document.createElement("div");
            grid.className = "days-grid";
            dayNames.forEach(d => {
                const dn = document.createElement("div");
                dn.className = "day-name";
                dn.textContent = d;
                grid.appendChild(dn);
            });
            const firstDay = new Date(year, index, 1).getDay();
            const jsDay = (firstDay === 0 ? 6 : firstDay - 1);
            for (let i = 0; i < jsDay; i++) {
                const empty = document.createElement("div");
                empty.className = "empty";
                grid.appendChild(empty);
            }
            const daysInMonth = new Date(year, index + 1, 0).getDate();
            for (let d = 1; d <= daysInMonth; d++) {
                const dayCell = document.createElement("div");
                dayCell.className = "day";
                dayCell.textContent = d;
                const dayOfWeek = new Date(year, index, d).getDay();
                if (year === today.getFullYear() && index === today.getMonth() && d === today.getDate()) {
                    dayCell.classList.add("today");
                } else if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayCell.style.background = "#ff8c00";
                    dayCell.style.color = "#111";
                }
                grid.appendChild(dayCell);
            }
            monthDiv.appendChild(grid);
            monthsContainer.appendChild(monthDiv);
        });
    }
    async function loadNewsTick() {
        const rssList = [
            'https://feeds.elpais.com/mrss-s/pages/ep/site/elpais.com/portada',
            'https://rss.nytimes.com/services/xml/rss/nyt/World.xml',
            'https://es.cointelegraph.com/rss'
        ];
        const randomFeed = rssList[Math.floor(Math.random() * rssList.length)];
        try {
            const response = await fetch(randomFeed);
            const str = await response.text();
            const data = new window.DOMParser().parseFromString(str, "text/xml");
            const items = data.querySelectorAll('item title');
            const titles = Array.from(items).slice(0,10).map(el => el.textContent);
            const tickerEl = document.getElementById('newsTicker');
            tickerEl.innerHTML = '<div class="ticker">' + titles.join(' • ') + '</div>';
        } catch(err) {
            console.error('Error Cargando Noticias:', err);
            document.getElementById('newsTicker').textContent = 'No Se Pudieron Cargar Noticias.';
        }
    }
    const currentYear = new Date().getFullYear();
    fillYearSelector(currentYear);
    generateCalendar(currentYear);
    loadNewsTick();
    let lastCalendarUpdate = 0;
    let lastNewsUpdate = 0;
    function mainLoop(timestamp) {
        updateClock();
        if (!lastCalendarUpdate || timestamp - lastCalendarUpdate > 60000) {
            const selectedYear = parseInt(yearSelector.value);
            generateCalendar(selectedYear);
            lastCalendarUpdate = timestamp;
        }
        if (!lastNewsUpdate || timestamp - lastNewsUpdate > 300000) {
            loadNewsTick();
            lastNewsUpdate = timestamp;
        }
        requestAnimationFrame(mainLoop);
    }
    requestAnimationFrame(mainLoop);
    yearSelector.addEventListener("change", () => {
        const selected = parseInt(yearSelector.value);
        generateCalendar(selected);
    });
</script>
</body>
</html>